#------------------------------------------------------------------------------
# Example configuration for enabling the Pipeline as a Code plugin and
# starting Dinghy service
#------------------------------------------------------------------------------
apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component

images:
  - name: docker.io/armory/dinghy
    newTag: 2.28.0

resources:
  - service.yml
  - deployment.yml
patchesStrategicMerge:
  - ./pac-plugin-config.yml

patchesJson6902:
  - target:
      kind: Deployment
      group: apps
      name: spin-dinghy
      version: v1
    patch: |-
      - op: replace
        path: /metadata/labels/app.kubernetes.io~1version
        value: 2.28.0
      - op: replace
        path: /spec/template/metadata/labels/app.kubernetes.io~1version
        value: 2.28.0

secretGenerator:
  - name: spin-dinghy-config-file
    files:
      - dinghy.yml
      - spinnaker.yml
  - name: pac-secret
    options:
      disableNameSuffixHash: true
    literals:
      - github-token=SampleAccessKey1!
